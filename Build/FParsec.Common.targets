<Project>

  <PropertyGroup>
    <LowTrust>false</LowTrust>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)' == 'Debug-LowTrust' or '$(Configuration)' == 'Release-LowTrust'">
    <LowTrust>true</LowTrust>
    <DefineConstants>$(DefineConstants);LOW_TRUST</DefineConstants>
    <AllowUnsafeBlocks>false</AllowUnsafeBlocks>
  </PropertyGroup>

  <PropertyGroup Condition="'$(LowTrust)' != 'true'">
    <TargetFrameworks>net45</TargetFrameworks>
  </PropertyGroup>
  <PropertyGroup Condition="'$(LowTrust)' == 'true'">
    <TargetFrameworks Condition="'$(OutputType)' != 'Exe'">netstandard2.0</TargetFrameworks>
    <TargetFrameworks Condition="'$(OutputType)' == 'Exe'">netcoreapp2.0</TargetFrameworks>
  </PropertyGroup>

  <Choose>
    <When Condition="'$(Configuration)' == 'Debug' or '$(Configuration)' == 'Debug-LowTrust'">
      <PropertyGroup>
        <DefineConstants>$(DefineConstants);DEBUG</DefineConstants>
      </PropertyGroup>
    </When>
    <When Condition="'$(Configuration)' == 'Release' or '$(Configuration)' == 'Release-LowTrust'">
      <PropertyGroup>
        <DefineConstants>$(DefineConstants);RELEASE</DefineConstants>
      </PropertyGroup>
    </When>
  </Choose>

  <PropertyGroup Condition="'$(LowTrust)' == 'true'">
    <DefineConstants>$(DefineConstants);SMALL_STATETAG</DefineConstants>
  </PropertyGroup>
  <PropertyGroup>
    <DefineConstants>$(DefineConstants);AGGRESSIVE_INLINING</DefineConstants>
  </PropertyGroup>
  <PropertyGroup Condition="'$(TargetFrameworkIdentifier)' == '.NETFramework'">
    <DefineConstants>$(DefineConstants);UNALIGNED_READS</DefineConstants>
  </PropertyGroup>
  <PropertyGroup Condition="'$(LowTrust)' == 'false' and '$(AssemblyName)' != 'FParsecCS'">
    <DefineConstants>$(DefineConstants);USE_STATIC_MAPPING_FOR_IS_ANY_OF</DefineConstants>
  </PropertyGroup>

  <PropertyGroup Condition="'$(FParsecNuGet)' == 'true'">
    <SignAssembly Condition="'$(TargetFrameworkIdentifier)' == '.NETFramework'">true</SignAssembly>
  </PropertyGroup>

  <PropertyGroup Condition="'$(SignAssembly)' == 'true'">
    <AssemblyOriginatorKeyFile>$(MSBuildThisFileDirectory)\fparsec.snk</AssemblyOriginatorKeyFile>
    <PublicSign Condition="'$(OS)' != 'Windows_NT'">true</PublicSign>
    <DefineConstants>$(DefineConstants);STRONG_NAME</DefineConstants>
  </PropertyGroup>

</Project>